---
import { getLangFromUrl, useTranslations } from '../i18n/utils';
import criticalCSS from '../styles/critical.css?raw';

export interface Props {
  title?: string;
  description?: string;
  keywords?: string;
}

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const { 
  title = t.meta.title,
  description = t.meta.description,
  keywords = t.meta.keywords
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site || 'https://baumstudios.com');
const ogImageURL = new URL('/og-image.jpg', Astro.site || 'https://baumstudios.com');
---

<!DOCTYPE html>
<html lang={lang}>
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q2924S7V08"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-Q2924S7V08');
  </script>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index, follow">
  <meta name="keywords" content={keywords}>
  <meta name="description" content={description}>
  <title>{title}</title>
  <link rel="canonical" href={canonicalURL} />
  <link rel="alternate" hreflang="en" href="https://baumstudios.com/" />
  <link rel="alternate" hreflang="hr" href="https://baumstudios.com/hr/" />
  <link rel="alternate" hreflang="x-default" href="https://baumstudios.com/" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content={canonicalURL} />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={ogImageURL} />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:locale" content={lang === 'hr' ? 'hr_HR' : 'en_US'} />
  <meta property="og:site_name" content="Baum Studios" />
  
  <!-- Twitter / X -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content={canonicalURL} />
  <meta name="twitter:title" content={title} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={ogImageURL} />
  
  <!-- Additional Meta Tags -->
  <meta name="author" content="Sara Blekić" />
  <meta name="generator" content={Astro.generator} />
  <meta name="geo.region" content="HR" />
  <meta name="geo.placename" content="Zagreb" />
  <meta name="geo.position" content="45.8150;15.9819" />
  <meta name="ICBM" content="45.8150, 15.9819" />
  
  <!-- Favicon - only load essential one initially -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <!-- Defer other favicon sizes -->
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" media="(min-width: 0px)">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" media="(min-width: 0px)">
  
  <!-- Resource Hints for Performance -->
  <link rel="dns-prefetch" href="https://player.vimeo.com">
  <link rel="dns-prefetch" href="https://f.vimeocdn.com">
  <link rel="dns-prefetch" href="https://i.vimeocdn.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://player.vimeo.com">
  
  <!-- Optimized Font Loading -->
  <link rel="preload" href="https://fonts.gstatic.com/s/karla/v31/qkBKXvYC6trAT7RbLtyG5Q.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Karla:wght@400;800&display=swap" as="style">
  <link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;800&display=swap" rel="stylesheet"></noscript>
  
  <!-- Inline Critical CSS -->
  <style set:html={criticalCSS}></style>
</head>
<body>
  <slot />
  
  <!-- Schema.org Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "ArchitecturalFirm",
        "@id": "https://baumstudios.com/#organization",
        "name": "Baum Studios",
        "alternateName": "Baum Studios Architecture",
        "url": "https://baumstudios.com",
        "logo": "https://baumstudios.com/og-image.jpg",
        "image": "https://baumstudios.com/og-image.jpg",
        "description": "Baum Studios is a spatial practice founded by Sara Blekić in Zagreb, Croatia, focusing on architecture and urbanism. The studio collaborates with various spatial and non-spatial practitioners on projects across multiple scales.",
        "founder": {
          "@type": "Person",
          "name": "Sara Blekić",
          "jobTitle": "Founder & Principal Architect"
        },
        "foundingDate": "2023",
        "foundingLocation": {
          "@type": "Place",
          "address": {
            "@type": "PostalAddress",
            "addressLocality": "Zagreb",
            "addressCountry": "HR"
          }
        },
        "areaServed": [
          {
            "@type": "City",
            "name": "Zagreb"
          },
          {
            "@type": "Country",
            "name": "Croatia"
          }
        ],
        "contactPoint": {
          "@type": "ContactPoint",
          "telephone": "+385-98-902-7051",
          "email": "info@baumstudios.com",
          "contactType": "customer service",
          "availableLanguage": ["en", "hr"]
        },
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Zagreb",
          "addressRegion": "Zagreb",
          "addressCountry": "HR"
        },
        "sameAs": [
          "https://www.instagram.com/baumstudios",
          "https://www.linkedin.com/company/baumstudios"
        ],
        "knowsAbout": [
          "Architecture",
          "Urban Design",
          "Urban Planning",
          "Spatial Design",
          "Architectural Design",
          "Sustainable Architecture",
          "Contemporary Architecture"
        ],
        "slogan": "between architecture and urban matters"
      },
      {
        "@type": "WebSite",
        "@id": "https://baumstudios.com/#website",
        "url": "https://baumstudios.com",
        "name": "Baum Studios",
        "description": "Architecture and Urban Design Practice in Zagreb",
        "publisher": {
          "@type": "Organization",
          "name": "Baum Studios",
          "url": "https://baumstudios.com",
          "logo": "https://baumstudios.com/og-image.jpg"
        },
        "inLanguage": ["en", "hr"]
      },
      {
        "@type": "ProfessionalService",
        "@id": "https://baumstudios.com/#service",
        "name": "Baum Studios Architectural Services",
        "serviceType": [
          "Architectural Design",
          "Urban Planning",
          "Spatial Design",
          "Design Consultation",
          "Project Development",
          "Conceptual Design",
          "Construction Documentation"
        ],
        "provider": {
          "@type": "Organization",
          "name": "Baum Studios"
        },
        "areaServed": {
          "@type": "Country",
          "name": "Croatia"
        },
        "availableLanguage": ["en", "hr"],
        "priceRange": "$$$"
      },
      {
        "@type": "LocalBusiness",
        "@id": "https://baumstudios.com/#localbusiness",
        "name": "Baum Studios",
        "image": "https://baumstudios.com/og-image.jpg",
        "telephone": "+385989027051",
        "email": "info@baumstudios.com",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "",
          "addressLocality": "Zagreb",
          "addressRegion": "Zagreb",
          "postalCode": "10000",
          "addressCountry": "HR"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 45.8150,
          "longitude": 15.9819
        },
        "url": "https://baumstudios.com",
        "openingHoursSpecification": [
          {
            "@type": "OpeningHoursSpecification",
            "dayOfWeek": [
              "Monday",
              "Tuesday",
              "Wednesday",
              "Thursday",
              "Friday"
            ],
            "opens": "09:00",
            "closes": "17:00"
          }
        ]
      }
    ]
  }
  </script>
  
  <script defer src="https://player.vimeo.com/api/player.js"></script>
</body>
</html>

<!-- Defer non-critical styles -->
<style is:global>
  /* Load non-critical styles after page load */
  @import '../styles/global.css';
</style>
